<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Análisis de Diseños Experimentales</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="bootstrap.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Estadística para la Construcción</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="aboutDoE.html">
    <span class="fas fa-book-open"></span>
     
    Acerca de
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Introducción
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="descrip.html">Descriptiva</a>
    </li>
    <li>
      <a href="prob.html">Probabilidad</a>
    </li>
    <li>
      <a href="inferencia.html">inferencia</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Diseños
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="anova.html">ANOVA y DCA</a>
    </li>
    <li>
      <a href="blocks.html">Bloques Aleatorios</a>
    </li>
    <li>
      <a href="fact1.html">Factoriales</a>
    </li>
    <li>
      <a href="fact2k.html">2 a la k</a>
    </li>
    <li>
      <a href="fact3k.html">3 a la k</a>
    </li>
    <li>
      <a href="fractional.html">Fraccionados</a>
    </li>
    <li>
      <a href="SurfResp.html">Superficies</a>
    </li>
    <li>
      <a href="sample.html">Muestras</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-chalkboard-teacher"></span>
     
    Regresión
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="slm.html">Simple</a>
    </li>
    <li>
      <a href="mlm.html">Múltiple</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-code"></span>
     
    R-Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Rinstall.html">Instalación</a>
    </li>
    <li>
      <a href="IntroR.html">Introducción</a>
    </li>
    <li>
      <a href="FunsR.html">Funciones y Paquetes</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:cdsanta@unal.edu.co.com">
    <span class="glyphicon glyphicon glyphicon glyphicon-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://cdsantae.github.io">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Análisis de Diseños Experimentales</h1>

</div>


<hr>
<div id="introducción" class="section level2">
<h2>Introducción</h2>
<p>En el capítulo de inferencia vimos como es el procedimiento estadístico para realizar comparaciones entre dos grupos independientes. Estos problemas también se puede ver como un diseño experimental de <strong>un factor</strong> con <strong>dos niveles</strong>, donde se tiene una <strong>variable respuesta</strong> que indica las medidas de interés y la <strong>variable dependiente</strong> corresponde al factor a evaluar con sus respectivos niveles.</p>
<p>suponga que el interés ahora es evaluar varios niveles de un solo factor, por ejemplo, la resistencia a la compresión del concreto en 5 días de curado.</p>
<p><img src="anova_files/figure-html/unnamed-chunk-1-1.png" width="540" style="display: block; margin: auto;" /></p>
<p>Esto significa que el planteamiento de las hipótesis a comparar son:</p>
<p><span class="math display">\[H_0: \mu_1=\mu_2=\mu_3=\mu_4=\mu_5\\
\text{vs}\\
H_a: \mu_1\neq\mu_2\neq\mu_3\neq\mu_4\neq\mu_5\]</span></p>
<p>En este caso los métodos de pruebas de hipótesis y de intervalos de confianza vistos no son suficientes para realizar múltiples comparaciones, esto se debe a que el <strong>Error tipo I</strong> aumenta considerablemente, ya que, la probabilidad <span class="math inline">\((1-\alpha)=0.95\)</span> de aceptar la hipótesis nula para 5 casos se convierte en <span class="math inline">\(0.95^5\approx 0.77\)</span>. Esta situación se le conoce como el aumento de la <strong>tasa de descubrimientos falsos</strong>, como alterativa existe un método capaz de probar la hipótesis de igualdad de <em>k</em> medias con un solo estadístico de prueba el cual se denomina <strong>Análisis de Varianza</strong> (ANOVA).</p>
<hr>
</div>
<div id="diseños-completamente-al-azar" class="section level2">
<h2>Diseños completamente al azar</h2>
<p>Es el más simple de todos los diseños, ya que el objetivo es comparar dos o más tratamientos y solo considera dos fuentes de variabilidad: <em>los tratamientos</em> y <em>el error aleatorio</em>. Se llama completamente al azar (DCA) porque todas las corridas se realizan en orden aleatorio completo con el fin de reducir los sesgos aleatorios y sistemáticos.</p>
<p>El análisis del diseño experimental se basa en resolver estadísticamente la siguiente ecuación:</p>
<p><span class="math display">\[\large y_{ij} = \mu+\tau_{i}+\varepsilon_{ij}\]</span></p>
<p>Donde <span class="math inline">\(y\)</span> representa la variable respuesta, <span class="math inline">\(\mu\)</span> es la media global ajustada o el promedio común a todos los tratamientos, <span class="math inline">\(\tau\)</span> representa el factor con <span class="math inline">\(i\)</span> niveles o tratamientos y <span class="math inline">\(\varepsilon\)</span> representa el error aleatorio asociado al diseño experimental o atribuible a la medición. Este modelo se conoce como <strong>modelo de efectos fijos</strong>.</p>
<blockquote>
<p><strong>Notación de puntos</strong><br> Antes de abordar los análisis de los datos para comparar tratamientos, conviene introducir la notación de puntos que simplifica las fórmulas para el análisis. Sirve para representar de manera abreviada cantidades numéricas que se pueden calcular a partir de los datos experimentales, donde <span class="math inline">\(Y_{ij}\)</span> representa la j-ésima observación en el tratamiento <em>i</em>, con <span class="math inline">\(i = 1, 2, \dots, k\)</span> y <span class="math inline">\(j = 1, 2, \dots, n_i\)</span>. Las cantidades de interés son las siguientes:<br><br> <span class="math inline">\(Y_i.=\)</span> Suma de las observaciones del tratamiento <em>i</em>.<br> <span class="math inline">\(\bar{Y}_i.=\)</span> Media de las observaciones del i-ésimo tratamiento.<br> <span class="math inline">\(Y.. =\)</span> Suma total de las <span class="math inline">\(N = n1 + n2 + \dots + nk\)</span> mediciones.<br> <span class="math inline">\(\bar{Y}..=\)</span> Media global o promedio de todas las observaciones.<br><br> Note que el punto indica la suma sobre el correspondiente subíndice. Así, algunas relaciones válidas son, <span class="math display">\[Y_i.=\sum_{j=1}^{n_i}Y_{ij}\quad \bar{Y}_i.=\frac{\sum_{j=1}^{n_i}Y_{ij}}{n_{i}}\quad Y..=\sum_{i=1}^{k}\sum_{j=1}^{n_i}Y_{ij}\quad \bar{Y}..=\frac{Y..}{N}\]</span> Donde <span class="math inline">\(N=\sum_{i=1}^k n_i\)</span> es el total de observaciones.</p>
</blockquote>
<hr>
</div>
<div id="anova" class="section level2">
<h2>ANOVA</h2>
<p>El objetivo del <strong>análisis de varianza</strong> en el DCA es probar la hipótesis de igualdad de los tratamientos con respecto a la media de la correspondiente variable de respuesta:</p>
<p><span class="math display">\[H_0: \mu_1=\mu_2=\dots=\mu_k=\mu\\
H_a: \mu_i \neq \mu_j \quad \text{para algún}\quad i \neq j\]</span></p>
<p>El cual se puede escribir de forma equivalente como:</p>
<p><span class="math display">\[H_0: \tau_1=\tau_2=\dots=\tau_k=0\\
H_a: \tau_i \neq 0 \quad \text{para algún}\quad i\]</span></p>
<p>Donde <span class="math inline">\(\tau_i\)</span> es el efecto del tratamiento <em>i</em> sobre la variable de respuesta. Si se acepta <span class="math inline">\(H_0\)</span> se confirma que los efectos sobre la respuesta de los <em>k</em> tratamientos son estadísticamente nulos (iguales a cero), y en caso de rechazar se estaría concluyendo que al menos un efecto es diferente de cero.</p>
<p>Para probar la hipótesis dada mediante la técnica de <strong>ANOVA</strong>, lo primero es descomponer la variabilidad total de los datos en sus dos componentes: la variabilidad debida a tratamientos y la que corresponde al error aleatorio, como se hace a continuación.</p>
<blockquote>
<p>Una medida de la variabilidad total presente en las observaciones es la <strong>suma total de cuadrados</strong> dada por <span class="math display">\[\begin{align*}SST=&amp;\sum_{i=1}^k \sum_{j=1}^{n_i} (Y_{ij}-\bar{Y}..)^2\\
=&amp;\sum_{i=1}^k \sum_{j=1}^{n_i} Y^2_{ij}-\frac{Y^2_{..}}{N}\\
=&amp;\sum_{i=1}^k \sum_{j=1}^{n_i}\left[(Y_{ij}-\bar{Y}_i.)+(\bar{Y}_i.-\bar{Y}_{..})\right]^2\\
=&amp;\sum_{i=1}^k n_i(\bar{Y}_i.-\bar{Y}_{..})^2+\sum_{i=1}^k \sum_{j=1}^{n_i}(Y_{ij}-\bar{Y}_i.)^2\\
=&amp;SSB+SSE
\end{align*}\]</span> La <span class="math inline">\(SSB\)</span> mide la variación o diferencias <strong>entre tratamientos</strong>. Mientras que la <span class="math inline">\(SSE\)</span> mide la variación <strong>dentro de tratamientos</strong>.</p>
</blockquote>
<p>Como hay un total de <span class="math inline">\(N\)</span> observaciones, entonces <span class="math inline">\(SST\)</span> tiene <span class="math inline">\(N-1\)</span> grados de libertad. Hay <span class="math inline">\(k\)</span> tratamientos o niveles de factor de interés, así que <span class="math inline">\(SSB\)</span> tiene <span class="math inline">\(k-1\)</span> grados de libertad, mientras que <span class="math inline">\(SSE\)</span> tiene <span class="math inline">\(N-k\)</span> grados de libertad, en términos de la ecuación de suma total de cuadrados, los grados de libertad son:</p>
<p><span class="math display">\[N-1=(k-1)+(N-k)\]</span></p>
<blockquote>
<p>Las sumas de cuadrados divididas entre sus respectivos grados de libertad se llaman <strong>cuadrados medios</strong>. Los dos que más interesan son el <strong>cuadrado medio de los tratamientos</strong> y el <strong>error cuadrático medio</strong>, que se denotan por: <span class="math display">\[MSB=\frac{SSB}{k-1}\qquad MSE=\frac{SSE}{N-k}\]</span></p>
</blockquote>
<p>Los valores esperados de los cuadrados medios están dados por:</p>
<p><span class="math display">\[E\left[MSE\right]=\sigma^2 \qquad E\left[MSB\right]=\sigma^2+\frac{\sum_{i=1}^{k}n_i\tau_i^2}{N-k}\]</span></p>
<p>Cuando la hipótesis nula es verdadera ambos cuadrados estiman la varianza <span class="math inline">\(\sigma^2\)</span>. Con base a este hecho construye el estadístico de prueba de la siguiente manera:</p>
<p><span class="math display">\[\frac{SSB}{\sigma^2} \sim \chi^2_{k-1} \qquad \frac{SSE}{\sigma^2} \sim \chi^2_{N-k}\]</span></p>
<p>Entonces:</p>
<p><span class="math display">\[F_0=\cfrac{MSB}{MSE} \sim F_{(k-1,\,N-k)}\]</span></p>
<p>Para un <span class="math inline">\(\alpha\)</span> dado, la Región Crítica es de la forma:</p>
<p><span class="math display">\[R.C: \{F_0 &gt; F_{1-\alpha,\,(k-1,\,N-k)}\} \qquad V_p: P(F_{(k-1,\,N-k)} &gt; F_0)\]</span></p>
<hr>
<div id="tabla-de-la-anova" class="section level3">
<h3>Tabla de la ANOVA</h3>
<p>Todo el procedimiento se puede resumir en una tabla, la cual indica los pasos del cálculo para realizar la comparación de grupos en un DCA.</p>
<center>
<table style="width:100%;">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th>Fuente de Variación</th>
<th>SS</th>
<th>gl</th>
<th>MS</th>
<th>F</th>
<th>valor-p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tratamientos</td>
<td><span class="math inline">\(SSB=\sum_{i=1}^{k}\frac{Y^2_i.}{n_i}-\frac{Y^2_{..}}{N}\)</span></td>
<td><span class="math inline">\(k-1\)</span></td>
<td><span class="math inline">\(MSB=\frac{SSB}{k-1}\)</span></td>
<td><span class="math inline">\(\frac{MSB}{MSE}\)</span></td>
<td><span class="math inline">\(P(F&gt;F_0)\)</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">\(SSE=SST-SSB\)</span></td>
<td><span class="math inline">\(N-k\)</span></td>
<td><span class="math inline">\(MSE=\frac{SSE}{N-k}\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(SST=\sum_{i=1}^k\sum_{j=i}^{n_i} Y^2_{ij}-\frac{Y^2_{..}}{N}\)</span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</center>
<hr>
</div>
</div>
<div id="validación-de-supuestos-del-modelo" class="section level2">
<h2>Validación de supuestos del modelo</h2>
<p>La validez de los resultados obtenidos en cualquier análisis de varianza queda supeditado a que los supuestos del modelo se cumplan. Estos supuestos son: <strong>normalidad</strong>, <strong>varianza constante</strong> (igual varianza de los tratamientos) e <strong>independencia</strong>.</p>
<p><span class="math display">\[Y_{ij} = \mu + \tau_i + \varepsilon_{ij}\]</span></p>
<p>Cuando se realiza el ANOVA y da significativo, entonces se procede a estimar el modelo ajustado:</p>
<p><span class="math display">\[\hat{Y}_{ij}=\hat\mu+\hat\tau_i\]</span></p>
<p>Donde <span class="math inline">\(\hat Y\)</span> indica la respuesta predicha, los demás estimadores representan el valor esperado de la media global y los tratamiento, el valor del término del error desaparece pues su valor esperado es igual a cero <span class="math inline">\(E[\varepsilon_{ij}]=0\)</span>. Como la media global se estima con <span class="math inline">\(\bar{Y}_{..}\)</span> y el efecto del tratamiento con <span class="math inline">\(\bar{Y}_i.-\bar{Y}_{..}\)</span>, el modelo ajustado del DCA se puede escribir como:</p>
<p><span class="math display">\[\hat{Y}_{ij}=\bar{Y}_{..}+(\bar{Y}_i.-\bar{Y}_{..})=\bar{Y}_i.\]</span></p>
<p>Esto es, la respuesta predicha para cada observación es la media muestral del tratamiento correspondiente. De esta manera, el <strong>residual o residuo</strong> asociado a la observación <span class="math inline">\(Y_{ij}\)</span> está dado por</p>
<p><span class="math display">\[e_{ij}=Y_{ij}-\hat{Y}_{ij}=Y_{ij}-\bar{Y}_i.\]</span></p>
<p>Los supuestos del modelo lineal, en términos de los residuos, son</p>
<ol style="list-style-type: decimal">
<li>Los <span class="math inline">\(e_{ij}\)</span> siguen una distribución normal con media cero.</li>
<li>Los <span class="math inline">\(e_{ij}\)</span> son independientes entre sí.</li>
<li>Los residuos de cada tratamiento tienen la misma varianza <span class="math inline">\(\sigma^2\)</span>.</li>
</ol>
<p>Estos supuestos se evaluan a través de pruebas de hipótesis, las más adecuadas para cada caso son:</p>
<ol style="list-style-type: decimal">
<li>Test de Shapito-Wilks</li>
<li>Test de Bartlett</li>
<li>Test de Durbin-Watson</li>
</ol>
<hr>
</div>
<div id="pruebas-post-hoc" class="section level2">
<h2>Pruebas Post-Hoc</h2>
<p>Después de que se rechazó la hipótesis nula en un análisis de varianza y validaron los supuestos del modelo, es necesario ir a detalle y ver cuáles tratamientos son diferentes.</p>
<hr>
<div id="método-lsd" class="section level3">
<h3>Método LSD</h3>
<p>Una vez que se rechazó <span class="math inline">\(H_0\)</span> en el ANOVA, el problema es probar la igualdad de todos los posibles pares de medias con la hipótesis:</p>
<p><span class="math display">\[H_0: \mu_i=\mu_j\\
H_1: \mu_i \neq \mu_j\]</span></p>
<p>Para $k4 tratamientos se tienen en total <span class="math inline">\(k(k – 1)/2\)</span> pares de medias. Por ejemplo, si k = 4 existen 4 × 3/2 = 6 posibles pares de medias. El método de <strong>diferencia mínima significativa</strong> busca la diferencia mínima que debe existir entre dos medias muestrales para considerar que los tratamientos correspondientes son significativamente diferentes. Así, cada diferencia de medias muestrales en valor absoluto que sea mayor que el número LSD se declara significativa.</p>
<p><span class="math display">\[|\hat{Y}_i.-\hat{Y}_j.|&gt;t_{(1-\alpha/2,\,N-k)}\sqrt{MSE \left(\frac{1}{n_i}+\frac{1}{n_j}\right)}=LSD\]</span></p>
<p>Si el diseño es balanceado, es decir, que los tamaños de muestra de cada tratamieno o nivel del factor es igual entonces:</p>
<p><span class="math display">\[LSD=t_{(1-\alpha/2,\,N-k)}\sqrt{\frac{2\times MSE}{n}}\]</span></p>
<hr>
</div>
<div id="método-tukey" class="section level3">
<h3>Método Tukey</h3>
<p>Un método más conservador para comparar pares de medias de tratamientos es el método de Tukey, el cual consiste en comparar las diferencias entre medias muestrales con el valor crítico dado por:</p>
<p><span class="math display">\[T_\alpha = q_{\alpha;(k,\,N-k)}\sqrt{\frac{MSE}{n_i}}\]</span></p>
<p>donde <span class="math inline">\(MSE\)</span> es el error cuadrático medio, <span class="math inline">\(n\)</span> es el número de observaciones por tratamiento, <span class="math inline">\(k\)</span> es el número de tratamientos, <span class="math inline">\(N – k\)</span> es igual a los grados de libertad para el error, <span class="math inline">\(\alpha\)</span> es el nivel de significancia prefijado y el estadístico <span class="math inline">\(q_{\alpha;(k, N – k)}\)</span> son puntos porcentuales de la distribución del rango estudentizado, que se obtienen de la tabla de rangos de Tukey.</p>
<hr>
</div>
<div id="método-duncan" class="section level3">
<h3>Método Duncan</h3>
<p>En este método para la comparación de medias, si las <span class="math inline">\(k\)</span> muestras son de igual tamaño, los <span class="math inline">\(k\)</span> promedios se acomodan en orden ascendente y el error estándar de los promedios se estima con <span class="math inline">\(S_{\bar{Y}_i.}=\sqrt{MSE/n}\)</span>. Si alguno o todos los tratamientos tienen tamaños diferentes, se reemplaza <span class="math inline">\(n\)</span> por la media armónica de las <span class="math inline">\(\{n_i\}\)</span>, que está dada por:</p>
<p><span class="math display">\[n_{AR}=\cfrac{1}{\sum_{i=1}^k \frac{1}{n_i}}\]</span></p>
<p>Luego se obtienen los rangos de significancia mínima:</p>
<p><span class="math display">\[R_p=r_{\alpha\,(p,l)}\sqrt{\frac{MSE}{n}}\]</span></p>
<p>Los valores críticos de <span class="math inline">\(r_\alpha\)</span> se obtienen de la tabla de rangos de Duncan. Las diferencias observadas entre las medias muestrales se comparan con los rangos <span class="math inline">\(R_p\)</span> de la siguiente manera: primero se compara la diferencia entre la media más grande y la más pequeña con el rango <span class="math inline">\(R_k\)</span>. Luego, la diferencia entre la media más grande y la segunda más pequeña se compara con el rango <span class="math inline">\(R_{k – 1}\)</span>. Estas comparaciones continúan hasta que la media mayor se haya comparado con todas las demás. Luego se repite el procedimiento fijando <span class="math inline">\(R_{k – 1}\)</span> para compararlas con las demás, así sucesivamente hasta comparar los <span class="math inline">\(k(k-1)/2\)</span> pares de medias. En las comparaciones donde la diferencia observada es mayor que el rango respectivo, se concluye que esas medias son significativamente diferentes.</p>
<hr>
</div>
<div id="método-dunnet" class="section level3">
<h3>Método Dunnet</h3>
<p>Una vez que se rechaza <span class="math inline">\(H_0\)</span> con el ANOVA, en ocasiones uno de los <span class="math inline">\(k\)</span> tratamientos a comparar es el llamado <strong>tratamiento control</strong> y el interés fundamental es comparar los <span class="math inline">\(k – 1\)</span> tratamientos restantes con dicho control.</p>
<p><span class="math display">\[|\hat{Y}_i.-\hat{Y}_k.|&gt; D_{\alpha\,(k-1,N-k)}\sqrt{MSE \left(\frac{1}{n_i}+\frac{1}{n_k}\right)}\]</span></p>
<p>Donde <span class="math inline">\(i=1,2,\dots,k-1\)</span> y <span class="math inline">\(D_\alpha\)</span> son los valores de la tabla de Dunnet con los respectivos grados de libertad.</p>
<hr>
</div>
</div>
<div id="ejemplo-1" class="section level2">
<h2>Ejemplo 1</h2>
<p>Un equipo de mejora investiga el efecto de cuatro métodos de ensamble A, B, C y D, sobre el tiempo de ensamble en minutos. En primera instancia, la estrategia experimental es aplicar cuatro veces los cuatro métodos de ensamble en orden completamente aleatorio (las 16 pruebas en orden aleatorio). Si se usa el diseño completamente al azar (DCA), se supone que, además del método de ensamble, no existe ningún otro factor que influya de manera significativa sobre la variable de respuesta (tiempo de ensamble). Los tiempos de ensamble obtenidos son:</p>
<center>
<table class="table table-striped">
<caption style="text-align:center">
Método de Ensamble
</caption>
<thead>
<tr>
<th style="text-align:center;">
A
</th>
<th style="text-align:center;">
B
</th>
<th style="text-align:center;">
C
</th>
<th style="text-align:center;">
D
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
10
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
12
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
11
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
9
</td>
</tr>
</tbody>
</table>
</center>
<p>El modelo a evaluar es:</p>
<p><span class="math display">\[y_{ij}=\mu+\tau_i+\varepsilon_{ij}\qquad \varepsilon_{ij}\sim N(0,\sigma^2)\]</span></p>
<p>Utilizando <code>R</code> el análisis estadístico de este diseño experimental es sencillo. Los pasos a seguir son los siguientes:</p>
<ol style="list-style-type: decimal">
<li>Cargar/Construir la base de datos con la información de interés.</li>
<li>Realizar un análisis descriptivo de la información.</li>
<li>Ajustar el modelo a través del ANOVA.</li>
<li>Validar los supuestos del modelo.</li>
<li>Realizar las pruebas post-hoc.</li>
</ol>
<p>Necesitamos las siguientes librerías.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para gráficos con estilo</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Para manejar bases de datos</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Para construir los qq-plots</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(car)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Para las pruebas de normalidad</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(nortest)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Para las pruebas post-hoc</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(agricolae)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(multcomp)</span></code></pre></div>
<p>El primer paso es cargar o construir la base de datos, esto puede hacerse en excel y luego importarlas a <code>R</code> o se puede construir la base de datos de la siguiente forma:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ejm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">respuesta=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">11</span>,<span class="dv">10</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">16</span>,<span class="dv">12</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">11</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tratamientos=</span><span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">4</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar la tabla de datos</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unstack</span>(ejm1)</span></code></pre></div>
<pre><code>##   A  B  C  D
## 1 6  7 11 10
## 2 8  9 16 12
## 3 7 10 11 11
## 4 8  8 13  9</code></pre>
<p>Los análisis descriptivos sirven para evaluar visualmente si existe un posible efecto del tratamiento en la variable respuesta, el mejor candidato para esta tarea es el BoxPlot.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># con Base</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(ejm1,<span class="fu">boxplot</span>(respuesta<span class="sc">~</span>tratamientos,<span class="at">las=</span><span class="dv">1</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main=</span><span class="st">&quot;Diagrama de Cajas y Bigotes&quot;</span>))</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-4-1.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># con ggplot</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ejm1,<span class="fu">aes</span>(<span class="at">x=</span>tratamientos,<span class="at">y=</span>respuesta,<span class="at">fill=</span>tratamientos))<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Diagrama de Cajas y Bigotes&quot;</span>)<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-4-2.png" width="540" style="display: block; margin: auto;" /></p>
<p>Luego se construye el modelo con el comando <code>aov</code> dando como argumentos la fórmula, después se ejecuta el comando <code>anova</code> para construir la tabla e interpretar.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anova</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(respuesta<span class="sc">~</span>tratamientos,<span class="at">data =</span> ejm1)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>(anvar <span class="ot">&lt;-</span> <span class="fu">anova</span>(fit))</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: respuesta
##              Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## tratamientos  3   69.5 23.1667  9.4237 0.001771 **
## Residuals    12   29.5  2.4583                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Por defecto la tabla ANOVA trae unos códigos de significancia de acuerdo al nivel <span class="math inline">\(\alpha\)</span> seleccionado por el investigador, para este caso nos dice que el valor-p es mucho menor a 0.01, si elegimos un <span class="math inline">\(\alpha=0.05\)</span> entonces se rechaza la hipótesis nula, es decir, existen diferencias significativas entre los tramientos del modelo.</p>
<p>Como el modelo es significativo, entonces es necesario validar los supuestos del modelo antes de realizar las pruebas post-hoc.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalidad</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fit<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(fit<span class="sc">$</span>residuals)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(fit<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">main=</span><span class="st">&quot;Normal Q-Q Plot&quot;</span>,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-6-1.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## [1]  7 11</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fit<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  fit$residuals
## W = 0.93389, p-value = 0.2808</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(fit<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  fit$residuals
## A = 0.34655, p-value = 0.435</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(fit<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit$residuals
## D = 0.12613, p-value = 0.7108</code></pre>
<p>Se cumple el supuesto de normalidad dado que no se rechaza la hipótesis nula.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># independecia</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Independencia&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-7-1.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(fit)</span></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       0.2415254      1.387712   0.372
##  Alternative hypothesis: rho != 0</code></pre>
<p>Se cumple el supuesto de independencia ya que no se halla autocorrelación en los errores del modelo.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homocedasticidad</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(fit<span class="sc">$</span>residuals,ejm1<span class="sc">$</span>tratamientos)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  fit$residuals and ejm1$tratamientos
## Bartlett&#39;s K-squared = 2.4853, df = 3, p-value = 0.4779</code></pre>
<p>De acuerdo a los resultados no existe diferencias de varianza entre los grupos, es decir, hay <strong>homcedasticidad</strong> u homogeneidad de varianzas.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supuestos globales</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-9-1.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-9-2.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-9-3.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-9-4.png" width="540" style="display: block; margin: auto;" /></p>
<p>Finalmente, como los supuestos del modelo se cumplen, entonces podemos buscar cuáles son los tratamientos más significativos sobre los tiempos de ensamble mediante las pruebas post-hoc</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Pruebas post-hoc ####</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># LSD</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>lsd <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(<span class="at">y =</span> fit,<span class="at">trt =</span> <span class="st">&quot;tratamientos&quot;</span>,<span class="at">console =</span> T)</span></code></pre></div>
<pre><code>## 
## Study: fit ~ &quot;tratamientos&quot;
## 
## LSD t Test for respuesta 
## 
## Mean Square Error:  2.458333 
## 
## tratamientos,  means and individual ( 95 %) CI
## 
##   respuesta       std r       LCL       UCL Min Max
## A      7.25 0.9574271 4  5.541912  8.958088   6   8
## B      8.50 1.2909944 4  6.791912 10.208088   7  10
## C     12.75 2.3629078 4 11.041912 14.458088  11  16
## D     10.50 1.2909944 4  8.791912 12.208088   9  12
## 
## Alpha: 0.05 ; DF Error: 12
## Critical Value of t: 2.178813 
## 
## least Significant Difference: 2.415602 
## 
## Treatments with the same letter are not significantly different.
## 
##   respuesta groups
## C     12.75      a
## D     10.50     ab
## B      8.50     bc
## A      7.25      c</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lsd,<span class="at">las=</span><span class="dv">1</span>);<span class="fu">grid</span>()</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-10-1.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>(hsd <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fit))</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = respuesta ~ tratamientos, data = ejm1)
## 
## $tratamientos
##      diff         lwr      upr     p adj
## B-A  1.25 -2.04155503 4.541555 0.6804513
## C-A  5.50  2.20844497 8.791555 0.0016206
## D-A  3.25 -0.04155503 6.541555 0.0533380
## C-B  4.25  0.95844497 7.541555 0.0110423
## D-B  2.00 -1.29155503 5.291555 0.3181239
## D-C -2.25 -5.54155503 1.041555 0.2309373</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hsd,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-10-2.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duncan</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">duncan.test</span>(<span class="at">y =</span> fit,<span class="at">trt =</span> <span class="st">&quot;tratamientos&quot;</span>,<span class="at">console =</span> T,<span class="at">group =</span> F)</span></code></pre></div>
<pre><code>## 
## Study: fit ~ &quot;tratamientos&quot;
## 
## Duncan&#39;s new multiple range test
## for respuesta 
## 
## Mean Square Error:  2.458333 
## 
## tratamientos,  means
## 
##   respuesta       std r Min Max
## A      7.25 0.9574271 4   6   8
## B      8.50 1.2909944 4   7  10
## C     12.75 2.3629078 4  11  16
## D     10.50 1.2909944 4   9  12
## 
## Comparison between treatments means
## 
##       difference pvalue signif.        LCL        UCL
## A - B      -1.25 0.2816         -3.6656016  1.1656016
## A - C      -5.50 0.0005     *** -8.0968097 -2.9031903
## A - D      -3.25 0.0158       * -5.7784415 -0.7215585
## B - C      -4.25 0.0031      ** -6.7784415 -1.7215585
## B - D      -2.00 0.0964       . -4.4156016  0.4156016
## C - D       2.25 0.0652       . -0.1656016  4.6656016</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dunnet</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Dunnett.mc <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">tratamientos =</span> <span class="st">&quot;Dunnett&quot;</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Dunnett.mc)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Dunnett Contrasts
## 
## 
## Fit: aov(formula = respuesta ~ tratamientos, data = ejm1)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## B - A == 0    1.250      1.109   1.127   0.5558    
## C - A == 0    5.500      1.109   4.961   &lt;0.001 ***
## D - A == 0    3.250      1.109   2.931   0.0319 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Dunnett.mc)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-10-3.png" width="540" style="display: block; margin: auto;" /></p>
<hr>
</div>
<div id="ejemplo-2" class="section level2">
<h2>Ejemplo 2</h2>
<p>Un fabricante de calzado desea mejorar la calidad de las suelas, las cuales se pueden hacer con uno de los cuatro tipos de cuero A, B, C y D disponibles en el mercado. Para ello, prueba los cueros con una máquina que hace pasar los zapatos por una superficie abrasiva; la suela de éstos se desgasta al pasarla por dicha superficie. Como criterio de desgaste se usa la pérdida de peso después de un número fijo de ciclos. Se prueban en orden aleatorio 24 zapatos, seis de cada tipo de cuero. Al hacer las pruebas en orden completamente al azar se evitan sesgos y las mediciones en un tipo de cuero resultan independientes de las demás. Los datos (en miligramos) sobre el desgaste de cada tipo de cuero se muestran a continuación.</p>
<center>
<table class="table table-striped">
<caption style="text-align:center">
Método de Ensamble
</caption>
<thead>
<tr>
<th style="text-align:center;">
A
</th>
<th style="text-align:center;">
B
</th>
<th style="text-align:center;">
C
</th>
<th style="text-align:center;">
D
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
264
</td>
<td style="text-align:center;">
208
</td>
<td style="text-align:center;">
220
</td>
<td style="text-align:center;">
217
</td>
</tr>
<tr>
<td style="text-align:center;">
260
</td>
<td style="text-align:center;">
220
</td>
<td style="text-align:center;">
263
</td>
<td style="text-align:center;">
226
</td>
</tr>
<tr>
<td style="text-align:center;">
258
</td>
<td style="text-align:center;">
216
</td>
<td style="text-align:center;">
219
</td>
<td style="text-align:center;">
215
</td>
</tr>
<tr>
<td style="text-align:center;">
241
</td>
<td style="text-align:center;">
200
</td>
<td style="text-align:center;">
225
</td>
<td style="text-align:center;">
227
</td>
</tr>
<tr>
<td style="text-align:center;">
262
</td>
<td style="text-align:center;">
213
</td>
<td style="text-align:center;">
230
</td>
<td style="text-align:center;">
220
</td>
</tr>
<tr>
<td style="text-align:center;">
255
</td>
<td style="text-align:center;">
206
</td>
<td style="text-align:center;">
228
</td>
<td style="text-align:center;">
222
</td>
</tr>
</tbody>
</table>
</center>
<p>El modelo a evaluar es:</p>
<p><span class="math display">\[y_{ij}=\mu+\tau_i+\varepsilon_{ij}\qquad \varepsilon_{ij}\sim N(0,\sigma^2)\]</span></p>
<p>Utilizando <code>R</code> el análisis estadístico de este diseño experimental es sencillo. Los pasos a seguir son los siguientes:</p>
<ol style="list-style-type: decimal">
<li>Cargar/Construir la base de datos con la información de interés.</li>
</ol>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ejm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">respuesta=</span><span class="fu">c</span>(<span class="dv">264</span>,<span class="dv">208</span>,<span class="dv">220</span>,<span class="dv">217</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">260</span>,<span class="dv">220</span>,<span class="dv">263</span>,<span class="dv">226</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">258</span>,<span class="dv">216</span>,<span class="dv">219</span>,<span class="dv">215</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">241</span>,<span class="dv">200</span>,<span class="dv">225</span>,<span class="dv">227</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">262</span>,<span class="dv">213</span>,<span class="dv">230</span>,<span class="dv">220</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                               <span class="dv">255</span>,<span class="dv">206</span>,<span class="dv">228</span>,<span class="dv">222</span>),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tratamientos=</span><span class="fu">rep</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">6</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> T)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar la tabla de datos</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">unstack</span>(ejm2)</span></code></pre></div>
<pre><code>##     A   B   C   D
## 1 264 208 220 217
## 2 260 220 263 226
## 3 258 216 219 215
## 4 241 200 225 227
## 5 262 213 230 220
## 6 255 206 228 222</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Realizar un análisis descriptivo de la información.</li>
</ol>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ejm2,<span class="fu">aes</span>(<span class="at">x=</span>tratamientos,<span class="at">y=</span>respuesta,<span class="at">fill=</span>tratamientos))<span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot;Diagrama de Cajas y Bigotes&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-12-1.png" width="540" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Ajustar el modelo a través del ANOVA.</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anova</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(respuesta<span class="sc">~</span>tratamientos,<span class="at">data =</span> ejm2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: respuesta
##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## tratamientos  3 7019.5 2339.82  22.755 1.176e-06 ***
## Residuals    20 2056.5  102.83                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Validar los supuestos del modelo.</li>
</ol>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normalidad</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fit2<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(fit2<span class="sc">$</span>residuals)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(fit2<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">main=</span><span class="st">&quot;Normal Q-Q Plot&quot;</span>,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-14-1.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## [1]  7 13</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(fit2<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  fit2$residuals
## W = 0.88326, p-value = 0.00967</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(fit2<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  fit2$residuals
## A = 0.64761, p-value = 0.08005</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(fit2<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  fit2$residuals
## D = 0.14365, p-value = 0.2256</code></pre>
<p>¿Los residuales del modelo distribuyen normalmente?</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># independecia</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>,<span class="at">type=</span><span class="st">&quot;b&quot;</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Independencia&quot;</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-15-1.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(fit2)</span></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       0.4405003      1.092512   0.034
##  Alternative hypothesis: rho != 0</code></pre>
<p>¿Existe independencia en los residuales del modelo?</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homocedasticidad</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(fit2<span class="sc">$</span>residuals,ejm2<span class="sc">$</span>tratamientos)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  fit2$residuals and ejm2$tratamientos
## Bartlett&#39;s K-squared = 7.4634, df = 3, p-value = 0.05851</code></pre>
<p>¿Se cumple el modelo de homocedasticidad?</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supuestos globales</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-17-1.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-17-2.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-17-3.png" width="540" style="display: block; margin: auto;" /><img src="anova_files/figure-html/unnamed-chunk-17-4.png" width="540" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: decimal">
<li>Realizar las pruebas post-hoc.</li>
</ol>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Pruebas post-hoc ####</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># LSD</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>lsd <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(<span class="at">y =</span> fit2,<span class="at">trt =</span> <span class="st">&quot;tratamientos&quot;</span>,<span class="at">console =</span> T)</span></code></pre></div>
<pre><code>## 
## Study: fit2 ~ &quot;tratamientos&quot;
## 
## LSD t Test for respuesta 
## 
## Mean Square Error:  102.825 
## 
## tratamientos,  means and individual ( 95 %) CI
## 
##   respuesta       std r      LCL      UCL Min Max
## A  256.6667  8.286535 6 248.0313 265.3020 241 264
## B  210.5000  7.259477 6 201.8646 219.1354 200 220
## C  230.8333 16.339115 6 222.1980 239.4687 219 263
## D  221.1667  4.792355 6 212.5313 229.8020 215 227
## 
## Alpha: 0.05 ; DF Error: 20
## Critical Value of t: 2.085963 
## 
## least Significant Difference: 12.21224 
## 
## Treatments with the same letter are not significantly different.
## 
##   respuesta groups
## A  256.6667      a
## C  230.8333      b
## D  221.1667     bc
## B  210.5000      c</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lsd,<span class="at">las=</span><span class="dv">1</span>);<span class="fu">grid</span>()</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-18-1.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey HSD</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>(hsd <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fit2))</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = respuesta ~ tratamientos, data = ejm2)
## 
## $tratamientos
##           diff        lwr        upr     p adj
## B-A -46.166667 -62.552998 -29.780336 0.0000008
## C-A -25.833333 -42.219664  -9.447002 0.0014117
## D-A -35.500000 -51.886331 -19.113669 0.0000349
## C-B  20.333333   3.947002  36.719664 0.0118160
## D-B  10.666667  -5.719664  27.052998 0.2926431
## D-C  -9.666667 -26.052998   6.719664 0.3742863</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hsd,<span class="at">las=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-18-2.png" width="540" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Duncan</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">duncan.test</span>(<span class="at">y =</span> fit2,<span class="at">trt =</span> <span class="st">&quot;tratamientos&quot;</span>,<span class="at">console =</span> T,<span class="at">group =</span> F)</span></code></pre></div>
<pre><code>## 
## Study: fit2 ~ &quot;tratamientos&quot;
## 
## Duncan&#39;s new multiple range test
## for respuesta 
## 
## Mean Square Error:  102.825 
## 
## tratamientos,  means
## 
##   respuesta       std r Min Max
## A  256.6667  8.286535 6 241 264
## B  210.5000  7.259477 6 200 220
## C  230.8333 16.339115 6 219 263
## D  221.1667  4.792355 6 215 227
## 
## Comparison between treatments means
## 
##       difference pvalue signif.        LCL       UCL
## A - B  46.166667 0.0000     ***  32.962466 59.370868
## A - C  25.833333 0.0003     ***  13.621091 38.045575
## A - D  35.500000 0.0000     ***  22.681249 48.318751
## B - C -20.333333 0.0032      ** -33.152084 -7.514582
## B - D -10.666667 0.0835       . -22.878909  1.545575
## C - D   9.666667 0.1143          -2.545575 21.878909</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dunnet</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>Dunnett.mc <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit2,<span class="at">linfct=</span><span class="fu">mcp</span>(<span class="at">tratamientos =</span> <span class="st">&quot;Dunnett&quot;</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Dunnett.mc)</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Dunnett Contrasts
## 
## 
## Fit: aov(formula = respuesta ~ tratamientos, data = ejm2)
## 
## Linear Hypotheses:
##            Estimate Std. Error t value Pr(&gt;|t|)    
## B - A == 0  -46.167      5.854  -7.886  &lt; 1e-04 ***
## C - A == 0  -25.833      5.854  -4.413 0.000633 ***
## D - A == 0  -35.500      5.854  -6.064  &lt; 1e-04 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Dunnett.mc,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">60</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="anova_files/figure-html/unnamed-chunk-18-3.png" width="540" style="display: block; margin: auto;" /></p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
